<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8 ie-7"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9 ie-8"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
	<head>
		<title>finfisher map</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<meta name="description" content="Map of FinFisher Malware Logfile A169FE42.rar" />
		<script src="http://d3js.org/d3.v3.min.js"></script>
		<script src="http://d3js.org/topojson.v1.min.js"></script>
		<script src="js/datamaps.all.js"></script>
		<style>body {font-family: sans-serif;} .warning { color: darkorange; } .footer {font-size: 0.8em;} #container {max-width: 100%!important; height: auto:}</style>
	</head>
	<body>
		<h1>FinFisherMap</h1>
		<p>Total impacted countries: 24<br />
		Total logged IP addresses: 2489<br />
		Unmapped: <a href="http://internetprotectionlab.net/ff-anonymous-proxy-ip-list/" target="_blank">Anonymous proxy IP addresses: 61</a><br />
		More about A169FE42.rar FinFisher malware logfile: <a target="_blank" href="http://internetprotectionlab.net/finfisher-hack-the-bahrain-logs/">internetprotectionlab.net/finfisher-hack-the-bahrain-logs/</a>
		</p>
		<noscript class="warning">Sorry, this map requires JavaScript.</noscript>
		<div id="container" style="position: relative; width: 900px; height: 500px;"></div>
		<script type="text/javascript">
			var map = new Datamap({
				element: document.getElementById('container'),
				scope: 'world',
				projection: 'equirectangular',
				geographyConfig: {
					borderColor: '#bbbbbb',
					borderWidth: 1,
					highlightFillColor: 'dodgerblue',
					//highlightBorderColor: 'dodgerblue',
					//highlightBorderColor: '#ffffff',
					popupTemplate: function(geo, data) {
						if(data != null) {
							return ['<div class="hoverinfo"><strong>' + geo.properties.name,
								'</strong><br />Number of geographical locations ',
								': ' + data.total,
								'</div>'].join('');
						} else {
							return ['<div class="hoverinfo"><strong>' + geo.properties.name,
								'</strong>',
								'</div>'].join('');
						}
					}
				},
				fills: {
					finfisher: 'crimson',
					geolocation: 'dodgerblue',
					defaultFill: '#eeeeee'
				},
				data: {
					// fixme country is missing from datamaps
					'BHR': {
						fillKey: 'finfisher',
						total: 1485
					},
					'GBR': {
						fillKey: 'finfisher',
						total: 340
					},
					'MAR': {
						fillKey: 'finfisher',
						total: 155
					},
					'IRN': {
						fillKey: 'finfisher',
						total: 110
					},
					'THA': {
						fillKey: 'finfisher',
						total: 99
					},
					'BEL': {
						fillKey: 'finfisher',
						total: 69
					},
					'RUS': {
						fillKey: 'finfisher',
						total: 43
					},
					'KWT': {
						fillKey: 'finfisher',
						total: 18
					},
					'DEU': {
						fillKey: 'finfisher',
						total: 15
					},
					'USA': {
						fillKey: 'finfisher',
						total: 15
					},
					'QAT': {
						fillKey: 'finfisher',
						total: 14
					},
					'CHE': {
						fillKey: 'finfisher',
						total: 12
					},
					'LBN': {
						fillKey: 'finfisher',
						total: 10
					},
					'ITA': {
						fillKey: 'finfisher',
						total: 8
					},
					'EGY': {
						fillKey: 'finfisher',
						total: 8
					},
					'SAU': {
						fillKey: 'finfisher',
						total: 6
					},
					'IRQ': {
						fillKey: 'finfisher',
						total: 6
					},
					'CYP': {
						fillKey: 'finfisher',
						total: 6
					},
					'YEM': {
						fillKey: 'finfisher',
						total: 2
					},
					'TUN': {
						fillKey: 'finfisher',
						total: 2
					},
					'UAE': {
						fillKey: 'finfisher',
						total: 2
					},
					'LIT': {
						fillKey: 'finfisher',
						total: 1
					},
					'SWE': {
						fillKey: 'finfisher',
						total: 1
					},
				}
			});
			var finFisher = [
				{
					name: 'Bahrain',
					total: '1485',
					radius: 150,
					country: 'BHR',
					fillKey: 'geolocation',
					latitude: 26,
					longitude: 50.56
				},
				{
					name: 'Great Britain',
					total: '340',
					radius: 100,
					country: 'GBR',
					fillKey: 'geolocation',
					latitude: 51,
					longitude: -0.12
				},
				{
					name: 'Morocco',
					total: '155',
					radius: 74.5,
					country: 'MAR',
					fillKey: 'geolocation',
					latitude: 32.91,
					longitude: -6.35
				},
				{
					name: 'Iran',
					total: '110',
					radius: 55,
					country: 'IRN',
					fillKey: 'geolocation',
					latitude: 32.47,
					longitude: 53.54
				},
				{
					name: 'Thailand',
					total: '99',
					radius: 49.5,
					country: 'THA',
					fillKey: 'geolocation',
					latitude: 15.49,
					longitude: 100.78
				},
				{
					name: 'Belgium',
					total: '69',
					radius: 34.5,
					country: 'BEL',
					fillKey: 'geolocation',
					latitude: 50.49,
					longitude: 4.65
				},
				{
					name: 'Russia',
					total: '43',
					radius: 30,
					country: 'RUS',
					fillKey: 'geolocation',
					latitude: 64.92,
					longitude: 99.31
				},
				{
					name: 'Kuwait',
					total: '18',
					radius: 18,
					country: 'KWT',
					fillKey: 'geolocation',
					latitude: 29.43,
					longitude: 47.53
				},
				{
					name: 'Germany',
					total: '18',
					radius: 18,
					country: 'DEU',
					fillKey: 'geolocation',
					latitude: 52.29,
					longitude: 11.62
				},
				{
					name: 'United States of America',
					total: '15',
					radius: 15,
					country: 'USA',
					fillKey: 'geolocation',
					latitude: 40.51,
					longitude: -100.15
				},
				{
					name: 'Qatar',
					total: '14',
					radius: 14,
					country: 'QTR',
					fillKey: 'geolocation',
					latitude: 25.36,
					longitude: 50.99
				},
				{
					name: 'Switzerland',
					total: '12',
					radius: 12,
					country: 'CHE',
					fillKey: 'geolocation',
					latitude: 46.83,
					longitude: 8.09
				},
				{
					name: 'Lebanon',
					total: '10',
					radius: 1,
					country: 'LEB',
					fillKey: 'geolocation',
					latitude: 34.05,
					longitude: 35.85
				},
				{
					name: 'Italy',
					total: '8',
					radius: 8,
					country: 'ITA',
					fillKey: 'geolocation',
					latitude: 42.29,
					longitude: 12.85
				},
				{
					name: 'Egypt',
					total: '8',
					radius: 8,
					country: 'EGY',
					fillKey: 'geolocation',
					latitude: 27.05,
					longitude: 30.69
				},
				{
					name: 'Saudi Arabia',
					total: '6',
					radius: 6,
					country: 'SAU',
					fillKey: 'geolocation',
					latitude: 24.56,
					longitude: 44.27
				},
				{
					name: 'Iraq',
					total: '6',
					radius: 6,
					country: 'IRQ',
					fillKey: 'geolocation',
					latitude: 33.21,
					longitude: 43.26
				},
				{
					name: 'Cyprus',
					total: '6',
					radius: 6,
					country: 'CYP',
					fillKey: 'geolocation',
					latitude: 34.85,
					longitude: 32.69
				},
				{
					name: 'Yemen',
					total: '2',
					radius: 2,
					country: 'YEM',
					fillKey: 'geolocation',
					latitude: 14.98,
					longitude: 47.55
				},
				{
					name: 'Tunisia',
					total: '2',
					radius: 2,
					country: 'TUN',
					fillKey: 'geolocation',
					latitude: 34.43,
					longitude: 9.85
				},
				{
					name: 'United Arab Emirates',
					total: '2',
					radius: 2,
					country: 'UAE',
					fillKey: 'geolocation',
					latitude: 23.65,
					longitude: 53.91
				},
				{
					name: 'Lithuania',
					total: '1',
					radius: 1,
					country: 'LIT',
					fillKey: 'geolocation',
					latitude: 55.60,
					longitude: 23.10
				},
				{
					name: 'Netherlands',
					total: '1',
					radius: 1,
					country: 'LIT',
					fillKey: 'geolocation',
					latitude: 52.14,
					longitude: 5.25
				},
				{
					name: 'Sweden',
					total: '1',
					radius: 1,
					country: 'SWE',
					fillKey: 'geolocation',
					latitude: 64.62,
					longitude: 17.62
				},
			];
			//draw bubbles
			map.bubbles(finFisher, {
				borderWidth: 1,
				borderColor: '#FFFFFF',
				popupOnHover: true,
				popupTemplate: function (geo, data) {
						return ['<div class="hoverinfo">' +  data.name,
						'<br/>Total location lookups: ' +  data.total,
						'</div>'].join('');
				},
				fillOpacity: 0.1,
				highlightOnHover: true,
				highlightFillColor: 'dodgerblue',
				highlightBorderColor: '#ffffff',
				highlightBorderWidth: 0,
				highlightFillOpacity: 0.85
			});
		</script>
		<footer class="footer">
			The bubbles are not real size, as numbers in Bahrain and the UK would largely overlap the map.<br />
			This map uses <a target="_blank" href="http://d3js.org">d3js</a> and <a target="_blank" href="http://datamaps.github.io">datamaps</a>.
			<br />Other than these files, the map is released under <a target="_blank" href="http://www.wtfpl.net/">WTFPL</a>.
			<br /><a target="_blank" href="https://github.com/u451f/finfisherMap">Fork it on Github</a>.
		</footer>
	</body>
</html>
